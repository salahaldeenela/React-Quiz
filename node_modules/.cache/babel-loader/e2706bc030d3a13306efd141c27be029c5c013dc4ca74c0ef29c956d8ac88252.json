{"ast":null,"code":"import{createContext,useContext,useReducer,useEffect}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";const QuizContext=/*#__PURE__*/createContext();const SECS_PER_QUESTION=30;const initialState={questions:[],// 'loading', 'error', 'ready', 'active', 'finished'\nstatus:\"loading\",index:0,answer:null,points:0,highscore:0,secondsRemaining:null};function reducer(state,action){switch(action.type){case\"dataReceived\":return{...state,questions:action.payload,status:\"ready\"};case\"dataFailed\":return{...state,status:\"error\"};case\"start\":return{...state,status:\"active\",secondsRemaining:state.questions.length*SECS_PER_QUESTION};case\"newAnswer\":const question=state.questions.at(state.index);return{...state,answer:action.payload,points:action.payload===question.correctOption?state.points+question.points:state.points};case\"nextQuestion\":return{...state,index:state.index+1,answer:null};case\"finish\":return{...state,status:\"finished\",highscore:state.points>state.highscore?state.points:state.highscore};case\"restart\":return{...initialState,questions:state.questions,status:\"ready\"};case\"tick\":return{...state,secondsRemaining:state.secondsRemaining-1,status:state.secondsRemaining===0?\"finished\":state.status};default:throw new Error(\"Action unkonwn\");}}function QuizProvider(_ref){let{children}=_ref;const[{questions,status,index,answer,points,highscore,secondsRemaining},dispatch]=useReducer(reducer,initialState);const numQuestions=questions.length;const maxPossiblePoints=questions.reduce((prev,cur)=>prev+cur.points,0);useEffect(function(){fetch(\"http://localhost:9000/questions\").then(res=>res.json()).then(data=>dispatch({type:\"dataReceived\",payload:data})).catch(err=>dispatch({type:\"dataFailed\"}));},[]);return/*#__PURE__*/_jsx(QuizContext.Provider,{value:{questions,status,index,answer,points,highscore,secondsRemaining,numQuestions,maxPossiblePoints,dispatch},children:children});}function useQuiz(){const context=useContext(QuizContext);if(context===undefined)throw new Error(\"QuizContext was used outside of the QuizProvider\");return context;}export{QuizProvider,useQuiz};","map":{"version":3,"names":["createContext","useContext","useReducer","useEffect","jsx","_jsx","QuizContext","SECS_PER_QUESTION","initialState","questions","status","index","answer","points","highscore","secondsRemaining","reducer","state","action","type","payload","length","question","at","correctOption","Error","QuizProvider","_ref","children","dispatch","numQuestions","maxPossiblePoints","reduce","prev","cur","fetch","then","res","json","data","catch","err","Provider","value","useQuiz","context","undefined"],"sources":["C:/Users/msi/course material/ultimate-react-course-main/10-react-quiz/final/src/contexts/QuizContext.js"],"sourcesContent":["import { createContext, useContext, useReducer, useEffect } from \"react\";\n\nconst QuizContext = createContext();\n\nconst SECS_PER_QUESTION = 30;\n\nconst initialState = {\n  questions: [],\n\n  // 'loading', 'error', 'ready', 'active', 'finished'\n  status: \"loading\",\n  index: 0,\n  answer: null,\n  points: 0,\n  highscore: 0,\n  secondsRemaining: null,\n};\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case \"dataReceived\":\n      return {\n        ...state,\n        questions: action.payload,\n        status: \"ready\",\n      };\n    case \"dataFailed\":\n      return {\n        ...state,\n        status: \"error\",\n      };\n    case \"start\":\n      return {\n        ...state,\n        status: \"active\",\n        secondsRemaining: state.questions.length * SECS_PER_QUESTION,\n      };\n    case \"newAnswer\":\n      const question = state.questions.at(state.index);\n\n      return {\n        ...state,\n        answer: action.payload,\n        points:\n          action.payload === question.correctOption\n            ? state.points + question.points\n            : state.points,\n      };\n    case \"nextQuestion\":\n      return { ...state, index: state.index + 1, answer: null };\n    case \"finish\":\n      return {\n        ...state,\n        status: \"finished\",\n        highscore:\n          state.points > state.highscore ? state.points : state.highscore,\n      };\n    case \"restart\":\n      return { ...initialState, questions: state.questions, status: \"ready\" };\n\n    case \"tick\":\n      return {\n        ...state,\n        secondsRemaining: state.secondsRemaining - 1,\n        status: state.secondsRemaining === 0 ? \"finished\" : state.status,\n      };\n\n    default:\n      throw new Error(\"Action unkonwn\");\n  }\n}\n\nfunction QuizProvider({ children }) {\n  const [\n    { questions, status, index, answer, points, highscore, secondsRemaining },\n    dispatch,\n  ] = useReducer(reducer, initialState);\n\n  const numQuestions = questions.length;\n  const maxPossiblePoints = questions.reduce(\n    (prev, cur) => prev + cur.points,\n    0\n  );\n\n  useEffect(function () {\n    fetch(\"http://localhost:9000/questions\")\n      .then((res) => res.json())\n      .then((data) => dispatch({ type: \"dataReceived\", payload: data }))\n      .catch((err) => dispatch({ type: \"dataFailed\" }));\n  }, []);\n\n  return (\n    <QuizContext.Provider\n      value={{\n        questions,\n        status,\n        index,\n        answer,\n        points,\n        highscore,\n        secondsRemaining,\n        numQuestions,\n        maxPossiblePoints,\n\n        dispatch,\n      }}\n    >\n      {children}\n    </QuizContext.Provider>\n  );\n}\n\nfunction useQuiz() {\n  const context = useContext(QuizContext);\n  if (context === undefined)\n    throw new Error(\"QuizContext was used outside of the QuizProvider\");\n  return context;\n}\n\nexport { QuizProvider, useQuiz };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}